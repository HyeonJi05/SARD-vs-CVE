# 📁 CVE-2019-16718

분석 보류: sink 파악에 디버깅 필요.. [관련 링크](https://allelesecurity.com/asa-2019-00543/)

> WARNING of joern parser 
>```bash
>(.ksign_slicer) root@0c13b466fbd1:/KSignSlicer# tools/ReVeal/code-slicer/joern/>joern-parse data/converged/CVE-2019-16718     && mv parsed/data/converged/>CVE-2019-16718/ data/cpg.csv/     && rm data/cpg.csv/CVE-2019-16718/*.csv     && rm -rf >parsed
>data/converged/CVE-2019-16718/after_cmd.c
>warning: unresolved break statement
>data/converged/CVE-2019-16718/before_cmd.c
>warning: unresolved break statement
>```

**🔗 [커밋 링크](https://github.com/radareorg/radare2/commit/dd739f5a45b3af3d1f65f00fe19af1dbfec7aea7)** | **🔗 [CVE 링크](https://www.cvedetails.com/cve/CVE-2019-16718)**

| 총 슬라이스 수* |  정탐 | 미탐 |
| --------  | -- | -- |
| 2개       | 0개 | 2개 |

\* cve 설명에 나온 취약한 함수에 대한 슬라이스만 고려

## 🔍 취약점 설명
> radare2 라는 실행 파일 리버싱 프로그램의 실행 파일 분석 기능에 있는 libr/core/cbin.c:bin_symbols()에서 발생한 OS Command Injection 취약점입니다.

* **취약 조건**: 입력값 검증 부재
* **취약 동작**: 입력값을 검증하지 않고 `system()` / `execl()` / 등의 위험한 함수 혹은 구문에 사용


### ❗️ 취약 코드

**문제점**:
사용자 입력이 적절히 검증되지 않은 채로 `system()` 함수의 인자로 사용되어 **명령어 인젝션**이 발생할 수 있음.

#### Sink: `CWE78_OS_Command_Injection__wchar_t_console_execl_53d.c:50`
```c
void CWE78_OS_Command_Injection__wchar_t_console_execl_53d_badSink(wchar_t * data)
{
    /* wexecl - specify the path where the command is located */
    /* POTENTIAL FLAW: Execute command without validating input possibly leading to command injection */
    EXECL(COMMAND_INT_PATH, COMMAND_INT_PATH, COMMAND_ARG1, COMMAND_ARG3, NULL);  /* POTENTIAL FLAW */
}
```


### ✅ 개선 코드

**패치 위치**: `파일명:줄번호`

```c
// 개선된 코드
char *input = getenv("USER_INPUT");
if (is_safe(input)) {
    system(input);
}
```

**개선 방법**:

* 입력값에 대해 필터링 또는 화이트리스트 검증을 추가하여 위험한 문자열을 제거
* 또는, `system()` 함수 대신 안전한 API 사용 고려

## SARD와 탐지 결과 비교
KSignSlicer의 AI 모델은 SARD CWE78에 대해 이러한 경우 취약으로 탐지해왔습니다. 그런데 이 취약점은 이러 이러한 사유로 이렇게 탐지된 것으로 보입니다.